# Code Similarity Project

This project computes various code similarity metrics including BLEU, Jaccard, TSED, and CodeBLEU.

## Setup Instructions

### Option 1: Using Conda (Recommended)

To replicate the exact environment used in this project:

1. Install Anaconda or Miniconda
2. Create the environment from the exported environment file:
   ```bash
   conda env create -f environment.yml
   ```
3. Activate the environment:
   ```bash
   conda activate similarity
   ```

### Option 2: Using pip

If you prefer to use pip:

1. Create a new virtual environment:
   ```bash
   python -m venv code_similarity_env
   source code_similarity_env/bin/activate  # On Windows: code_similarity_env\Scripts\activate
   ```

2. Install dependencies from requirements.txt:
   ```bash
   pip install -r requirements.txt
   ```

## Running the Code

After setting up the environment, you can run the similarity computation with:

```bash
python get_similarity.py
```

Or run the test script:

```bash
python get_similarity_test.py
```

## Project Structure

- `TSED/`: Contains the Tree Edit Distance implementation
  - Uses tree-sitter to parse code into ASTs
  - Implements the TSED algorithm for measuring structural similarity
- `CGED/`: Contains the Code Graph Edit Distance implementation
  - Uses Joern to parse code into graphs
  - Implements graph edit distance for code similarity
- `datasets/`: Sample datasets for testing
- `similarity_results/`: Output directory for similarity computations

## Components

### TSED (Tree Similarity of Edit Distance)

Measures similarity by calculating the edit distance between Abstract Syntax Trees (ASTs) of code snippets.

Key features:
- Uses tree-sitter for robust parsing across multiple languages
- Implements the APTED algorithm for tree edit distance
- Supports customization of edit operation weights

### CGED (Code Graph Edit Distance)

Measures similarity by calculating the edit distance between code property graphs generated by Joern.

Key features:
- Leverages Joern's advanced static analysis capabilities
- Works with code property graphs for deeper semantic understanding
- Containerized Joern worker for easy deployment

### Other Metrics

- BLEU: N-gram based similarity metric commonly used in machine translation
- Jaccard: Set-based similarity metric using token intersections
- CodeBLEU: Extension of BLEU that incorporates syntactic and semantic information

## Dependencies Overview

Key dependencies include:
- `tree-sitter`: For parsing code into ASTs
- `codebleu`: For CodeBLEU metric computation
- `numpy`, `pandas`: For data processing
- `networkx`: For graph-based representations
- `joern`: For code property graph generation (used in CGED)

For detailed dependency versions, see `requirements.txt` and `environment.yml`.